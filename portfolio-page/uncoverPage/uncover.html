<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="icon" href="../../img/favicon.webp">
  <link rel="stylesheet" href="./uncover.css">
  <link rel="stylesheet" href="../../fontawesome/css/all.min.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/monokai-sublime.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

  <title>Demuu Portfolio</title>
</head>
<body>

  <header>
    <div id="header">
      <div class="header-container clearfix">
        <div class="header-logo">
          <a href="../../main-page/index.html"><img src="../../img/faviconB.webp" alt="logo"/></a>
        </div>
        <div class="header-menu">
          <ul>
            <li>
              <a href="../../main-page/index.html">Home</a>
            </li>
            <li>
              <a href="../../portfolio-page/portfolio.html">Portfolio</a>
            </li>
            <li>
              <a href="../../gallery-page/gallery.html">Gallery</a>
            </li>
            <li>
              <a href="https://preasim.github.io">Blog</a>
            </li>
          </ul>
        </div>
    
        <!-- ----- header-menu2 (576px or less) ----- -->
        <div class="header-menu2">
          <div class="circle"></div>
          <div class="menu2-menus">
            <ul>
              <li><a href="../../main-page/index.html">Home</a></li>
              <li><a href="../../portfolio-page/portfolio.html">Portfolio</a></li>
              <li><a href="../../gallery-page/gallery.html">Gallery</a></li>
              <li><a href="https://preasim.github.io">Blog</a></li>
            </ul>
          </div>
          <div class="burger">
            <div class="x"></div>
            <div class="y"></div>
            <div class="z"></div>
          </div> 
        </div>
      </div>
    </div>
  </header>
  
  <div id="toc">
    <p><a href="#summary">- Summary</a></p>
    <p><a href="#architecture">- Architecture</a></p>
    <p><a href="#experience">- Experience</a></p>
    <p><a href="#retrospective">- Retrospective</a></p>
  </div>

  <div class="break-container">
    <div class="portfolio">
      <h2 class="date">2023.04.28 ~ 2023.05.31</h2>
      <h2 class="projectName">UNCOVER</h2>
      <h2 class="teamName">Team. Undefined</h2>

      <div id="summary">
        <h2 class="title">Summary</h2>

        <p class="summary-link"><a href="">Website</a> / <a href="">Github</a> / <a href="">Notion</a> / <a href="">기술 발표 영상</a></p>
        <br>
        <br>
        <p>No Copyright Music 서비스 플랫폼 / 저작권이 자유로는 음악들을 서비스하는 웹사이트입니다.</p>
        <p>평소 EDM 음악을 즐겨 듣는 저의 취미에서 착안하여, 인터랙티브 웹을 강조한 기획을 진행했습니다.</p>
        <br>
        <br>
        <p>Java와 Spring Boot를 활용한 프로젝트로, 팀 내에서의 첫 번째 경험이었습니다.</p>
        <p>팀원들과 함께 처음 시도하는 프로젝트였기에 서로 질의응답하며 고민하는 과정이 흥미로웠고, 이를 통해 많이 배울 수 있었습니다.</p>
        <p>커뮤니케이션 능력 향상과 함께 Java, Spring Boot에 대한 익숙함도 함께 얻을 수 있었습니다.</p>
        <br>
        <br>
        <p>이 프로젝트는 이전까지의 공부와는 다르게 팀 프로젝트를 성공적으로 마무리한 경험이었습니다.</p>
        <p>이를 통해 자발적인 학습과 실전 경험의 중요성을 깨달았으며, 이전과는 다른 수준의 자신감을 얻을 수 있었습니다.</p>
        <br>
        <br>
        <p style="font-weight: 600;">Front-end : React, Recoil, TypeScript, Node.js, Styled-Components, Axios</p>
        <p style="font-weight: 600;">Back-end : Java, Spring Boot, JWT, OAuth2, Gradle, Tomcat</p>
        <p style="font-weight: 600;">Database : MySQL, AWS, H2</p>
        <p style="font-weight: 600;">ETC : Postman, ngrok, git</p>
      </div>

      <div id="architecture">
        <h2 class="title">Architecture</h2>
        <p><a href="../../img/Architecture2.webp" target="_blank">ERD 바로가기 <i class="fa-solid fa-chevron-right"></i></a></p>
        <p><a href="https://documenter.getpostman.com/view/25524075/2s93eX1DP8#de8c1b63-20c9-40cf-ad48-514269974fb3" target="_blank">API 바로가기 <i class="fa-solid fa-chevron-right"></i></a></p>

        <div class="stack">
          <img src="../../img/Architecture1.webp">
        </div>
      </div>

      <div id="experience">
        <h2 class="title">Experience</h2>
        <p>이 프로젝트에서 저는 팀 리더로서 기획부터 아키텍처 설계, 가이드 문서 작성, 디자인 아이디어 제시를 주도했습니다.</p>
        <p>기술적인 측면에서는 주로 플레이리스트와 관련된 부분에 집중했습니다.</p>
        <p>구체적으로는 플레이리스트, 플레이리스트 댓글, 좋아요 기능, 그리고 태그 및 플레이리스트 태그를 구현하는 등의 작업을 수행했습니다.</p>
        <div class="cl3"></div>
        <p>플레이리스트는 멤버, 음악, 태그, 댓글, 좋아요 등 모든 부분과 연결되어 있어 예상보다 복잡한 작업이었습니다.</p>
        <p>미숙함으로 인해 다른 테이블과의 연관관계 매핑이 어려웠고, 이에 따른 작업이 상당한 시간을 필요로 했습니다.</p>

        <div id="toggle-code" class="toggle-code-1">
          <div class="toggle-code-btn tcb1">
            <p>소스코드 보기</p>
            <i id="toggle-right" class="fa-solid fa-angle-right tr1"></i>
            <i id="toggle-down" class="fa-solid fa-angle-down td1"></i>
          </div>
          <pre>
            <code class="language-java">
              @ElementCollection(fetch = FetchType.LAZY)
              private List&lt;String> tags = new ArrayList<>();
    
              @OneToMany(mappedBy = "playList", cascade = {CascadeType.ALL})
              private List&lt;PlayListTag> playListTags = new ArrayList<>();
    
              @OneToMany(mappedBy = "playList", cascade = {CascadeType.ALL})
              private List&lt;PlayListLike> playListLikes = new ArrayList<>();
    
              @OneToMany(mappedBy = "playList", cascade = {CascadeType.ALL})
              private List&lt;PlayListComment> playListComments = new ArrayList<>();
    
              @Column(nullable = false)
              private int likeCount = this.playListLikes.size();
    
              @OneToMany(mappedBy = "playList", cascade = {CascadeType.ALL})
              private List&lt;PlayListMusic> playlistMusics = new ArrayList<>();
            </code>
          </pre>
        </div>
        
        <p>이 경험을 통해 데이터베이스 디자인과 연관된 실무 능력을 향상시키는 계기가 되었습니다.</p>
        <div class="cl2"></div>
        <p>또한 프로젝트가 진행되면서, 사용자의 역할(role)에 따른 권한 설정에 대한 이슈도 함께 다뤘습니다.</p>
        <p>이는 관리자 계정과 사용자 계정으로 권한을 나누고, 그에 따라 다른 기능을 제공하도록 하였습니다.</p>
        <p>이 부분은 프로젝트 시작 전부터 공부하고 싶었던 주제였으며,</p>
        <p>실제로 구현해보니 이론에서 얻지 못했던 깊은 이해와 새로운 인사이트를 얻을 수 있었습니다.</p>

        <div id="toggle-code" class="toggle-code-2">
          <div class="toggle-code-btn tcb2">
            <p>소스코드 보기</p>
            <i id="toggle-right" class="fa-solid fa-angle-right tr2"></i>
            <i id="toggle-down" class="fa-solid fa-angle-down td2"></i>
          </div>
          <pre>
            <code class="language-java">
              public Member createMember(Member member) {
                  verifyExistEmail(member.getEmail());
                  member.setName(verifyExistName(member.getName()));
          
                  // (3) 추가: Password 암호화
                  String encryptedPassword = passwordEncoder.encode(member.getPassword());
                  member.setPassword(encryptedPassword);
          
                  // (4) 추가: DB에 User Role 저장
                  List&lt;String> roles = authorityUtils.createRoles(member.getEmail());
                  member.setRoles(roles);
          
                  Member savedMember = memberRepository.save(member);
          
                  return savedMember;
              }

              public Member createMemberOAuth2(Member member) {
                  List&lt;String> roles = authorityUtils.createRoles(member.getEmail());
                  member.setRoles(roles);
                  String newName = verifyExistName(member.getName());
                  member.setName(newName);
          
                  return memberRepository.save(member);
              }

              public void deletePlayList(long playListId, long memberId){
                  PlayList playList = findVerifiedPlayList(playListId);
                  Member member = memberService.findMember(memberId);
          
                  if (!member.getRoles().contains("ADMIN")) {
                      if (!member.getMemberId().equals(playList.getMember().getMemberId())){
                          throw new BusinessLogicException(ExceptionCode.NO_PERMISSION_DELETING_POST);
                      }
                  }
                  member.removePlayList(playList);
                  playListRepository.delete(playList);
              }

              public PlayListComment updateComment(long memberId, long commentId, String content){
                  PlayListComment comment = getComment(commentId);
                  Member member = memberService.findMember(memberId);
          
                  if (!member.getRoles().contains("ADMIN")) {
                      if (!member.getMemberId().equals(comment.getMember().getMemberId())){
                          throw new BusinessLogicException(ExceptionCode.NO_PERMISSION_DELETING_POST);
                      }
                  }
          
                  comment.setContent(content);
                  return commentRepository.save(comment);
              }

              public void deleteComment(long memberId, long commentId){
                  PlayListComment comment = getComment(commentId);
                  Member member = memberService.findMember(memberId);
          
                  if (!member.getRoles().contains("ADMIN")) {
                      if (!member.getMemberId().equals(comment.getMember().getMemberId())){
                          throw new BusinessLogicException(ExceptionCode.NO_PERMISSION_DELETING_POST);
                      }
                  }
                  commentRepository.delete(comment);
              }
            </code>
          </pre>
        </div>

        <div class="cl2"></div>
        <p>마지막으로 프로젝트 중에 발생한 동시성 문제에 대한 해결책 모색과 코드 리팩토링을 통해 성능 개선을 이루어냈습니다.</p>
        <p>동시에 여러 사용자가 좋아요 기능을 사용할 때, 좋아요 수는 1만 증가하는 이 동시성 문제는 이번 프로젝트 중 가장 깊게 고민한 문제입니다.</p>

        <div id="toggle-code" class="toggle-code-3">
          <div class="toggle-code-btn tcb3">
            <p>소스코드 보기</p>
            <i id="toggle-right" class="fa-solid fa-angle-right tr3"></i>
            <i id="toggle-down" class="fa-solid fa-angle-down td3"></i>
          </div>
          <pre>
            <code class="language-java">
              @OneToMany(mappedBy = "playList", cascade = {CascadeType.ALL})
              private List&lt;PlayListLike> playListLikes = new ArrayList<>();
  
              @Column(nullable = false)
              private int likeCount = this.playListLikes.size();
  
              public void addPlayListLike(PlayListLike playListLike) {
                  this.playListLikes.add(playListLike);
                  playListLike.setPlayList(this);
                  this.likeCount = this.playListLikes.size();
              }
  
              public void removePlayListLike(PlayListLike playListLike) {
                  this.playListLikes.remove(playListLike);
                  if(playListLike.getPlayList() != this) {
                      playListLike.setPlayList(this);
                  }
                  this.likeCount = this.playListLikes.size();
              }
  
              // --------------- playListLike Service -----------------
              public PlayListLike addLike(Long memberId, Long playListId){
                  Member member = memberService.findMember(memberId);
                  PlayList playList = playListService.findVerifiedPlayList(playListId);
          
                  PlayListLike like = new PlayListLike();
                  like.setMember(member);
                  like.setPlayList(playList);
          
                  playList.addPlayListLike(like);
                  member.addLikedPlayLists(like);
          
                  return playListLikeRepository.save(like);
              }
          
              public void cancelLike(Long memberId, Long playListId){
                  Member member = memberService.findMember(memberId);
                  PlayList playList = playListService.findVerifiedPlayList(playListId);
                  List&lt;PlayListLike> likes = getAllLikesForMemberAndPlayList(memberId, playListId);
          
                  for (PlayListLike like : likes) {
                      if (member.getMemberId().equals(like.getMember().getMemberId())) {
                          playListLikeRepository.delete(like);
                          playList.removePlayListLike(like);
                          member.removeLikedPlayLists(like);
                      } else throw new BusinessLogicException(ExceptionCode.NO_PERMISSION_EDITING_COMMENT);
                  }
              }
            </code>
          </pre>
        </div>

        <p><a href="https://preasim.github.io/44" style="text-decoration: underline;" target="_blank">동시성 문제 해결법 (블로그) ></a></p>
        <div class="cl3"></div>
        <p>고민 끝에 unique 값인 memberId를 사용해 List에 넣고 그 사이즈를 좋아요 개수로 반환하도록 해결했습니다.</p>
        <p>이러한 경험을 통해 코드 품질 향상과 효율적인 프로젝트 진행을 위한 노하우를 얻게 되었습니다.</p>
        <div class="cl3"></div>
        <p>이러한 어려움에 직면하면서도 팀원들과의 원활한 협업을 통해 공동의 목표를 달성하기 위해 노력했습니다.</p>
        <p>특히, 플레이리스트 관련 기능에 대한 사용자 피드백을 수렴하고, 이를 바탕으로 지속적인 업데이트 및 개선 작업을 진행하였습니다.</p>
        <p>사용자들의 다양한 기대에 부응하면서 기능을 확장하고 최적화함으로써 사용자 경험을 꾸준히 향상 시켰습니다.</p>
        <div class="cl3"></div>
        <p>앞으로는 이러한 경험을 기반으로 더욱 복잡하고 대규모의 프로젝트에서도 효과적으로</p>
        <p>리더십을 발휘하고, 기술적인 도전에 더욱 안정적으로 대처해 나가고자 합니다.</p>

        
      </div>

      <div id="retrospective">
        <h2 class="title">Retrospective</h2>
      </div>
    </div>
  </div>



  <!-- <div class="link">
    <div class="item">
      <a href="">
        <div class="name">Website</div>
        <div class="icon">
          <i class="fa-solid fa-chevron-right"></i>
        </div>
      </a>
    </div>
    <div class="item">
      <a href="">
        <div class="name">Github</div>
        <div class="icon">
          <i class="fa-solid fa-chevron-right"></i>
        </div>
      </a>
    </div>
    <div class="item">
      <a href="">
        <div class="name">Notion</div>
        <div class="icon">
          <i class="fa-solid fa-chevron-right"></i>
        </div>
      </a>
    </div>
    <div class="item">
      <a href="">
        <div class="name">기술 발표 영상</div>
        <div class="icon">
          <i class="fa-solid fa-chevron-right"></i>
        </div>
      </a>
    </div>
  </div> -->


  <script src="../../common/header.js"></script>
  <script src="./uncover.js"></script>
  <script>hljs.highlightAll();</script>
  <script>
    let fullHeight = Math.max(
      document.body.scrollHeight,
      document.body.offsetHeight,
      document.documentElement.clientHeight,
      document.documentElement.scrollHeight,
      document.documentElement.offsetHeight
    );

    console.log("페이지의 총 높이: " + fullHeight + "px");

    var fullWidth = Math.max(
      document.body.scrollWidth,
      document.body.offsetWidth,
      document.documentElement.clientWidth,
      document.documentElement.scrollWidth,
      document.documentElement.offsetWidth
    );

    console.log("페이지의 총 너비: " + fullWidth + "px");


    var element = document.querySelector("#summary");
    var elementHeight = element.offsetTop;
    console.log("Summary 높이: " + elementHeight + "px");
  </script>
</body>
</html>